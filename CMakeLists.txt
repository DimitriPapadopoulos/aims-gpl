cmake_minimum_required( VERSION 2.6 )
find_package( brainvisa-cmake REQUIRED )
BRAINVISA_PROJECT()

BRAINVISA_FIND_PACKAGE( aims-free REQUIRED )
find_package( Qt REQUIRED )
if( DESIRED_QT_VERSION EQUAL 4 )
  find_package( Qt4 COMPONENTS QtCore QtGui Qt3Support REQUIRED )
endif()
find_package( QtVersion REQUIRED )
find_package( Doxygen )

BRAINVISA_DEPENDENCY( DEV DEPENDS "${BRAINVISA_PACKAGE_NAME}" RUN "= ${${BRAINVISA_PACKAGE_NAME}_VERSION}" )
BRAINVISA_DEPENDENCY( RUN DEPENDS aims-free RUN "= ${aims-free_VERSION}" )
BRAINVISA_DEPENDENCY( DEV DEPENDS aims-free DEV )
BRAINVISA_DEPENDENCY( RUN DEPENDS qt${DESIRED_QT_VERSION} RUN "= ${QT_VERSION}" )
math( EXPR result "${DESIRED_QT_VERSION} + 1" )
BRAINVISA_DEPENDENCY( DEV DEPENDS qt${DESIRED_QT_VERSION} DEV ">= ${DESIRED_QT_VERSION};<< ${result}" )

if( DESIRED_QT_VERSION EQUAL 3 )
  include_directories( ${QT_INCLUDE_DIR} )
  add_definitions( ${QT_DEFINITIONS} )
else()
  include( "${QT_USE_FILE}" )
endif()
include( "${AIMS-FREE_USE_FILE}" )

add_subdirectory( src )

BRAINVISA_CREATE_CMAKE_CONFIG_FILES()
